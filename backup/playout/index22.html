<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>IPTV Player</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.3.5/shaka-player.compiled.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body, html { height: 100%; font-family: sans-serif; background: #000; color: #fff; }
    .app { display: flex; flex-direction: column; height: 100vh; }
    .channel-list {
      overflow-x: auto;
      display: flex;
      gap: 10px;
      padding: 10px;
      background: #111;
    }
    .channel {
      display: flex;
      flex-direction: column;
      align-items: center;
      cursor: pointer;
    }
    .channel img {
      width: 60px;
      height: 60px;
      border-radius: 10px;
      object-fit: cover;
    }
    .channel span {
      font-size: 12px;
      margin-top: 5px;
      text-align: center;
      max-width: 70px;
    }
    .channel.active img {
      border: 2px solid #e91e63;
    }

    #video-container {
      flex: 1;
      position: relative;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    video {
      width: 100%;
      height: auto;
      max-height: 100%;
    }
    .controls {
      position: absolute;
      bottom: 10%;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      background: rgba(0,0,0,0.5);
      padding: 10px 20px;
      border-radius: 30px;
    }
    .controls button {
      background: #fff;
      border: none;
      padding: 10px;
      border-radius: 50%;
      font-size: 16px;
      cursor: pointer;
    }
    .controls button:hover {
      background: #e91e63;
      color: #fff;
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="channel-list" id="channelList"></div>
    <div id="video-container">
      <video id="video" autoplay muted playsinline></video>
      <div class="controls">
        <button onclick="nextChannel()">‚è≠</button>
        <button onclick="toggleMute()">üîà</button>
        <button onclick="toggleFullscreen()">‚õ∂</button>
        <button onclick="changeQuality()">‚öôÔ∏è</button>
      </div>
    </div>
  </div>

  <script>
    const video = document.getElementById('video');
    const channelListEl = document.getElementById('channelList');

    const channels = [
      {
        name: "Hum TV",
        logo: "https://ev-img-cdn-lb.shoq.com.pk/prd-peg-data/default/images/logos/live/Hum.png",
        url: "https://live2.shoq.com.pk/live/eds/HUM_TV/DASH/HUM_TV.mpd",
        drm: {
          "org.w3.clearkey": {
            "clearkeys": {
              "83404dd4292fec9e27173696f6e42dee": "a9dd477034d4fb2e7e5dc7c21ce73fed"
            }
          }
        }
      },
      {
        name: "9XM",
        logo: "https://prodcdn1.wavespb.com/shows/thumbnail/6041427509XM.webp",
        url: "https://d3kdywbtdfbp9z.cloudfront.net/v1/master/93ce20f0f52760bf38be911ff4c91ed02aa2fd92/dff423e0-3c82-46d6-9ecb-3baa96b5694a/master.m3u8"
      },
      {
        name: "And TV SD",
        logo: "https://imagesdishtvd2h.whatsonindia.com/dasimages/channel/landscape/360x270/T1CCvaAQ.png",
        url: "https://d1g8wgjurz8via.cloudfront.net/bpk-tv/Andtv/default/manifest.mpd",
        drm: {
          "org.w3.clearkey": {
            "clearkeys": {
              "26df86eeebb04d7fbc45c948f76e81fd": "5f3a23f1a73c4c96ababce5fffe7b06b"
            }
          }
        }
      },
      {
        name: "Disney Channel",
        logo: "https://jiotvimages.cdn.jio.com/dare_images/images/Disney_Channel.png",
        url: "https://jiotvmblive.cdn.jio.com/bpk-tv/Disney_Channel_BTS/output/index.mpd?__hdnea__=st=1749693758~exp=1749780158~acl=/*~hmac=8982ea93670ffa788eb63640cece916b4d1150ac7a6df7de74569c680c9559f6",
        drm: {
          "org.w3.clearkey": {
            "clearkeys": {
              "5181d3e6698055578cedc5bfc86b3e56": "3dca7917d8cf9bb7095dc72b48bdcd3c"
            }
          }
        }
      },
      {
        name: "&pictures HD",
        logo: "",
        url: "http://38.76.152.22:8000/play/a01t/index.m3u8"
      },
      {
        name: "Zee News",
        logo: "https://jiotvimages.cdn.jio.com/dare_images/images/Zee_News.png",
        url: "https://z5ak-cmaflive.zee5.com/cmaf/live/2105510/ZEENEWSELE/master.m3u8"
      }
    ];

    let currentChannel = 0;
    let player;

    async function initPlayer() {
      shaka.polyfill.installAll();
      if (shaka.Player.isBrowserSupported()) {
        player = new shaka.Player(video);
        loadChannel(currentChannel);
      } else {
        alert("Browser not supported");
      }
    }

    async function loadChannel(index) {
      currentChannel = index;
      const ch = channels[index];

      [...channelListEl.children].forEach((el, i) => {
        el.classList.toggle("active", i === index);
      });

      try {
        await player.detach();
        await player.unload();
        player.configure({ drm: {} });

        if (ch.drm) {
          player.configure({ drm: { clearKeys: ch.drm["org.w3.clearkey"].clearkeys } });
        }

        await player.load(ch.url);
      } catch (error) {
        console.error("Playback error:", error);
      }
    }

    function nextChannel() {
      const next = (currentChannel + 1) % channels.length;
      loadChannel(next);
    }

    function toggleMute() {
      video.muted = !video.muted;
    }

    function toggleFullscreen() {
      if (!document.fullscreenElement) {
        video.requestFullscreen();
      } else {
        document.exitFullscreen();
      }
    }

    function changeQuality() {
      const tracks = player.getVariantTracks();
      const active = tracks.find(t => t.active);
      const current = tracks.indexOf(active);
      const next = (current + 1) % tracks.length;
      player.selectVariantTrack(tracks[next], true);
    }

    function createChannelList() {
      channels.forEach((ch, i) => {
        const div = document.createElement("div");
        div.className = "channel";
        if (i === currentChannel) div.classList.add("active");

        const img = document.createElement("img");
        img.src = ch.logo || "https://via.placeholder.com/60x60?text=TV";
        const name = document.createElement("span");
        name.textContent = ch.name;

        div.appendChild(img);
        div.appendChild(name);
        div.onclick = () => loadChannel(i);
        channelListEl.appendChild(div);
      });
    }

    createChannelList();
    initPlayer();
  </script>
</body>
</html>
